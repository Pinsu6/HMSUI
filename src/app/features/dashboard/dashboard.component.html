<div class="dashboard">
  <!-- Page Header -->
  <div class="page-header">
    <div>
      <h1 class="page-title">Dashboard</h1>
      <p class="page-subtitle">Welcome back, {{ userName }}! Here's what's happening at your hotel today.</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" routerLink="/check-in">
        <span>‚ûï</span> New Check-In
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <!-- Occupancy Card -->
    <div class="stat-card occupancy-card">
      <div class="stat-card-header">
        <div class="stat-card-icon occupancy">üè®</div>
        <div class="occupancy-ring">
          <svg viewBox="0 0 100 100">
            <circle class="ring-bg" cx="50" cy="50" r="40" />
            <circle class="ring-fill" cx="50" cy="50" r="40" [style.stroke-dasharray]="251.2"
              [style.stroke-dashoffset]="251.2 - (251.2 * occupancyRate / 100)" />
          </svg>
          <span class="ring-value">{{ occupancyRate }}%</span>
        </div>
      </div>
      <div class="stat-card-body">
        <span class="stat-card-value">{{ stats.occupiedRooms }}/{{ stats.totalRooms }}</span>
        <span class="stat-card-label">Rooms Occupied</span>
      </div>
    </div>

    <!-- Vacant Rooms -->
    <div class="stat-card">
      <div class="stat-card-icon vacant">üõèÔ∏è</div>
      <span class="stat-card-value">{{ stats.vacantRooms }}</span>
      <span class="stat-card-label">Vacant Rooms</span>
      <div class="stat-card-footer success">
        <span>Available for booking</span>
      </div>
    </div>

    <!-- Today's Check-ins -->
    <div class="stat-card">
      <div class="stat-card-icon checkin">üì•</div>
      <span class="stat-card-value">{{ stats.todaysCheckIns }}</span>
      <span class="stat-card-label">Today's Check-ins</span>
      <div class="stat-card-footer info">
        <span>Expected arrivals</span>
      </div>
    </div>

    <!-- Today's Check-outs -->
    <div class="stat-card">
      <div class="stat-card-icon checkout">üì§</div>
      <span class="stat-card-value">{{ stats.todaysCheckOuts }}</span>
      <span class="stat-card-label">Today's Check-outs</span>
      <div class="stat-card-footer warning">
        <span>Pending departures</span>
      </div>
    </div>

    <!-- Total Guests -->
    <div class="stat-card">
      <div class="stat-card-icon guests">üë•</div>
      <span class="stat-card-value">{{ stats.totalGuestsInHouse }}</span>
      <span class="stat-card-label">Guests In-House</span>
      <div class="stat-card-footer">
        <span>Currently staying</span>
      </div>
    </div>

    <!-- Dirty Rooms -->
    <div class="stat-card">
      <div class="stat-card-icon dirty">üßπ</div>
      <span class="stat-card-value">{{ stats.dirtyRooms }}</span>
      <span class="stat-card-label">Rooms to Clean</span>
      <div class="stat-card-footer danger">
        <span>Needs attention</span>
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="dashboard-content">
    <!-- Left Column -->
    <div class="dashboard-main">
      <!-- Today's Arrivals -->
      <div class="card animate-slide-up">
        <div class="card-header">
          <h3 class="card-title">üì• Today's Arrivals</h3>
          <a routerLink="/check-in" class="view-all">View All ‚Üí</a>
        </div>
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>Guest Name</th>
                <th>Room</th>
                <th>Time</th>
                <th>Guests</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let arrival of todayArrivals">
                <td>
                  <div class="guest-info">
                    <span class="guest-avatar">{{ arrival.guest?.fullName?.charAt(0) || 'G' }}</span>
                    <span class="guest-name">{{ arrival.guest?.fullName || 'Guest' }}</span>
                  </div>
                </td>
                <td><span class="room-number">{{ arrival.room?.number }}</span></td>
                <td>{{ arrival.checkInTime | date:'shortTime' }}</td>
                <td>{{ arrival.adults + arrival.children }}</td>
                <td>
                  <span class="badge" [class.badge-success]="arrival.status === 'Active'"
                    [class.badge-warning]="arrival.status !== 'Active'">
                    {{ arrival.status }}
                  </span>
                </td>
                <td>
                  <button class="btn btn-sm btn-primary">Check-In</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Today's Departures -->
      <div class="card animate-slide-up">
        <div class="card-header">
          <h3 class="card-title">üì§ Today's Departures</h3>
          <a routerLink="/check-out" class="view-all">View All ‚Üí</a>
        </div>
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>Guest Name</th>
                <th>Room</th>
                <th>Time</th>
                <th>Balance</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let departure of todayDepartures">
                <td>
                  <div class="guest-info">
                    <span class="guest-avatar">{{ departure.guest?.fullName?.charAt(0) || 'G' }}</span>
                    <span class="guest-name">{{ departure.guest?.fullName || 'Guest' }}</span>
                  </div>
                </td>
                <td><span class="room-number">{{ departure.room?.number }}</span></td>
                <td>{{ departure.expectedCheckOutTime | date:'shortTime' }}</td>
                <td>
                  <span [class.text-danger]="departure.totalAmount > 0">
                    ‚Çπ{{ departure.totalAmount | number }}
                  </span>
                </td>
                <td>
                  <span class="badge" [class.badge-success]="departure.status === 'Completed'"
                    [class.badge-warning]="departure.status === 'Active'">
                    {{ departure.status }}
                  </span>
                </td>
                <td>
                  <button class="btn btn-sm" [class.btn-secondary]="departure.status === 'Completed'"
                    [class.btn-danger]="departure.status === 'Active'">
                    {{ departure.status === 'Completed' ? 'Invoice' : 'Check-Out' }}
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- This Week's Bookings -->
      <div class="card animate-slide-up">
        <div class="card-header">
          <h3 class="card-title">üìÖ This Week's Bookings</h3>
        </div>
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>Check-In</th>
                <th>Guest</th>
                <th>Room</th>
                <th>Nights</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let booking of thisWeekBookings">
                <td>
                  <div class="date-info">
                    <span class="date-day">{{ booking.checkInTime | date:'dd' }}</span>
                    <span class="date-month">{{ booking.checkInTime | date:'MMM' }}</span>
                  </div>
                </td>
                <td>
                  <div class="guest-info">
                    <span class="guest-avatar">{{ booking.guest?.fullName?.charAt(0) || 'G' }}</span>
                    <span class="guest-name">{{ booking.guest?.fullName || 'Guest' }}</span>
                  </div>
                </td>
                <td><span class="room-number">{{ booking.room?.number || 'N/A' }}</span></td>
                <td>
                  {{ (booking.expectedCheckOutTime.getTime() - booking.checkInTime.getTime()) / (1000 * 3600 * 24) |
                  number:'1.0-0' }}
                </td>
                <td>
                  <span class="badge" [class.badge-success]="booking.status === 'Active'"
                    [class.badge-danger]="booking.status === 'Cancelled'"
                    [class.badge-secondary]="booking.status === 'Completed'">
                    {{ booking.status }}
                  </span>
                </td>
              </tr>
              <tr *ngIf="thisWeekBookings.length === 0">
                <td colspan="5" class="text-center text-muted py-4">
                  No bookings scheduled for this week
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>


    </div>

    <!-- Right Column - Sidebar -->
    <div class="dashboard-sidebar">
      <!-- Alerts and Recent Activity sections removed as they were demo-only -->

      <!-- Quick Actions -->
      <div class="card quick-actions-card animate-slide-up">
        <div class="card-header">
          <h3 class="card-title">‚ö° Quick Actions</h3>
        </div>
        <div class="quick-actions">
          <button class="quick-action-btn" routerLink="/check-in">
            <span class="action-icon">üìù</span>
            <span>New Check-In</span>
          </button>
          <!-- <button class="quick-action-btn" routerLink="/guests">
            <span class="action-icon">üë§</span>
            <span>Add Guest</span>
          </button> -->
          <button class="quick-action-btn" routerLink="/rooms">
            <span class="action-icon">üõèÔ∏è</span>
            <span>Room Status</span>
          </button>
          <button class="quick-action-btn" routerLink="/billing">
            <span class="action-icon">üßæ</span>
            <span>Generate Bill</span>
          </button>
        </div>
      </div>

      <!-- Booking Calendar -->
      <div class="card calendar-card animate-slide-up">
        <div class="card-header">
          <h3 class="card-title">üìÖ Booking Calendar</h3>
        </div>
        <div class="calendar-header">
          <button class="cal-nav-btn" (click)="changeMonth(-1)">‚óÄ</button>
          <span class="cal-month">{{ calendarDate | date:'MMMM yyyy' }}</span>
          <button class="cal-nav-btn" (click)="changeMonth(1)">‚ñ∂</button>
        </div>
        <div class="calendar-grid">
          <div class="cal-day-header">S</div>
          <div class="cal-day-header">M</div>
          <div class="cal-day-header">T</div>
          <div class="cal-day-header">W</div>
          <div class="cal-day-header">T</div>
          <div class="cal-day-header">F</div>
          <div class="cal-day-header">S</div>

          <div *ngFor="let day of calendarDays" class="cal-day" [class.empty]="!day.date"
            [class.has-activity]="day.checkIns > 0 || day.checkOuts > 0" [class.today]="day.isToday"
            [title]="day.fullDate ? (day.checkIns + ' Check-ins, ' + day.checkOuts + ' Check-outs') : ''">
            <span *ngIf="day.date">{{ day.date }}</span>
            <div *ngIf="day.checkIns > 0 || day.checkOuts > 0" class="cal-dots">
              <span *ngIf="day.checkIns > 0" class="dot dot-in"></span>
              <span *ngIf="day.checkOuts > 0" class="dot dot-out"></span>
            </div>

            <!-- Hover Tooltip -->
            <div class="cal-tooltip" *ngIf="day.date && (day.checkIns > 0 || day.checkOuts > 0)">
              <div class="tooltip-row">
                <span class="dot dot-in"></span> {{ day.checkIns }} In
              </div>
              <div class="tooltip-row">
                <span class="dot dot-out"></span> {{ day.checkOuts }} Out
              </div>
            </div>
          </div>
        </div>
        <div class="calendar-legend">
          <div class="legend-item"><span class="dot dot-in"></span> Check-In</div>
          <div class="legend-item"><span class="dot dot-out"></span> Check-Out</div>
        </div>
      </div>
    </div>

    <!-- Room Status Grid -->
    <div class="card animate-slide-up room-status-card">
      <div class="card-header">
        <h3 class="card-title">üè† Room Status Overview</h3>
        <a routerLink="/rooms" class="view-all">Manage Rooms ‚Üí</a>
      </div>
      <div class="room-status-legend">
        <div class="legend-item">
          <span class="legend-dot vacant"></span>
          <span>Vacant</span>
        </div>
        <div class="legend-item">
          <span class="legend-dot occupied"></span>
          <span>Occupied</span>
        </div>
        <div class="legend-item">
          <span class="legend-dot dirty"></span>
          <span>Dirty</span>
        </div>
        <div class="legend-item">
          <span class="legend-dot maintenance"></span>
          <span>Maintenance</span>
        </div>
      </div>
      <div class="room-grid">
        <div *ngFor="let room of rooms" class="room-tile" [class]="getRoomStatus(room)">
          <span class="room-number">{{ room.number }}</span>
          <span class="room-type">{{ room.roomType?.name }}</span>
          <span class="room-guest" *ngIf="getRoomGuest(room)">{{ getRoomGuest(room) }}</span>
        </div>
      </div>
    </div>
  </div>
</div>